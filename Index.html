<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lua Encryptor - GitHub Pages</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;padding:18px;max-width:920px;margin:0 auto;color:#111}
    h1{font-size:20px;margin-bottom:6px}
    textarea{width:100%;min-height:200px;padding:10px;font-family:monospace;font-size:13px;box-sizing:border-box}
    .row{display:flex;gap:8px;margin-top:8px;align-items:center}
    input[type=text]{flex:1;padding:8px}
    button{padding:8px 12px;border:0;background:#0b63d6;color:#fff;border-radius:6px;cursor:pointer}
    pre{white-space:pre-wrap;background:#f6f8fa;padding:10px;border-radius:6px;overflow:auto}
    small{color:#666}
    footer{margin-top:18px;color:#666;font-size:12px}
  </style>
</head>
<body>
  <h1>Lua Encryptor (sederhana)</h1>
  <p>Paste script <strong>Lua</strong> kamu di sini, pilih password XOR (opsional), lalu klik <em>Encrypt</em>. Hasil: XOR + Base64 obfuscation.</p>

  <label>Masukkan Lua:</label>
  <textarea id="luaIn" placeholder="-- paste lua script disini..."></textarea>

  <div class="row">
    <label style="min-width:110px">Password (opsional):</label>
    <input id="pwd" type="text" placeholder="ketik password untuk XOR (boleh kosong)">
    <button id="btnEncrypt">Encrypt</button>
    <button id="btnClear" style="background:#777;margin-left:6px">Clear</button>
  </div>

  <h3>Hasil (obfuscated):</h3>
  <pre id="out" style="min-height:120px">— hasil akan muncul di sini —</pre>

  <div class="row" style="margin-top:8px">
    <button id="downloadBtn">Download hasil (.lua.obf)</button>
    <small> — file bisa kamu simpan lalu distribusikan.</small>
  </div>

  <footer>
    <p><strong>Disclaimer:</strong> Tool ini hanya melakukan obfuscation sederhana (XOR + Base64). Tidak menjamin keamanan terhadap reverse-engineering. Gunakan untuk tujuan yang sah.</p>
  </footer>

<script>
(function(){
  function xorBytes(bytes, key) {
    if (!key || key.length === 0) return bytes;
    var k = new TextEncoder().encode(key);
    var out = new Uint8Array(bytes.length);
    for (var i = 0; i < bytes.length; i++) {
      out[i] = bytes[i] ^ k[i % k.length];
    }
    return out;
  }
  function strToUtf8Bytes(s){
    return new TextEncoder().encode(s);
  }
  function bytesToBase64(bytes){
    // convert to binary string
    var binary = '';
    var len = bytes.byteLength;
    for (var i = 0; i < len; i++) binary += String.fromCharCode(bytes[i]);
    return btoa(binary);
  }
  function base64ToBytes(b64){
    var binary = atob(b64);
    var len = binary.length;
    var bytes = new Uint8Array(len);
    for (var i=0;i<len;i++) bytes[i] = binary.charCodeAt(i);
    return bytes;
  }

  var btn = document.getElementById('btnEncrypt');
  var luaIn = document.getElementById('luaIn');
  var pwd = document.getElementById('pwd');
  var out = document.getElementById('out');
  var downloadBtn = document.getElementById('downloadBtn');
  var btnClear = document.getElementById('btnClear');

  btn.addEventListener('click', function(){
    var text = luaIn.value || '';
    if (!text) { alert('Masukkan script Lua dulu.'); return; }
    var key = pwd.value || '';
    // convert to bytes, xor, then base64
    var bytes = strToUtf8Bytes(text);
    var xored = xorBytes(bytes, key);
    var b64 = bytesToBase64(xored);
    // include a small header marker so user tahu ini obf
    var final = '--OBFUSCATED:XOR+BASE64\n' + (key ? ('--PWD:' + (key.length>0 ? '[user-supplied]':'') + '\n') : '') + b64;
    out.textContent = final;
  });

  btnClear.addEventListener('click', function(){
    luaIn.value=''; out.textContent='— hasil akan muncul di sini —'; pwd.value='';
  });

  downloadBtn.addEventListener('click', function(){
    var data = out.textContent;
    if (!data || data.indexOf('— hasil') === 0) { alert('Belum ada hasil untuk di-download'); return; }
    var blob = new Blob([data], {type:'text/plain'});
    var url = URL.createObjectURL(blob);
    var a = document.createElement('a');
    a.href = url;
    a.download = 'script.lua.obf';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

})();
</script>
</body>
</html>
